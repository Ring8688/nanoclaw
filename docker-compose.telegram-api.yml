services:
  telegram-bot-api:
    image: aiogram/telegram-bot-api:latest
    restart: unless-stopped
    user: "1001:1001"
    environment:
      TELEGRAM_API_ID: ${TELEGRAM_API_ID}
      TELEGRAM_API_HASH: ${TELEGRAM_API_HASH}
      TELEGRAM_LOCAL: "true"
    ports:
      - "8081:8081"
    volumes:
      - ./data/telegram-bot-api:/var/lib/telegram-bot-api
    entrypoint: ["/bin/sh", "-c"]
    command:
      - |
        mkdir -p /var/lib/telegram-bot-api/tmp
        exec /usr/local/bin/telegram-bot-api \
          --dir=/var/lib/telegram-bot-api \
          --temp-dir=/var/lib/telegram-bot-api/tmp \
          --http-port=8081 \
          --local \
          --api-id=$$TELEGRAM_API_ID \
          --api-hash=$$TELEGRAM_API_HASH
